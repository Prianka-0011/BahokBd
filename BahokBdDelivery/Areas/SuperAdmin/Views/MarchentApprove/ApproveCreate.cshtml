@model BahokBdDelivery.ViewModels.MarchentApproveVm
@{
    ViewData["Title"] = "ApproveCreate";
}

<div class="row">
    <div class="col-12 col-lg-10 offset-lg-2">
        <div class="card mb-4">
            <div class="card-header bg-info">
                <h2>Aprove</h2>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 offset-md-4">
                        <ul class="list-group" id="AreaList">

                            @foreach (var area in ViewBag.deiveryArea)
                            {
                                <li class="list-group-item">
                                    @*<input type="hidden" id="marchentId" value="@Model.MarchentId" />*@
                                    <input id="check_@area.Id" type="checkbox" checked="@area.Status" />
                                    <label for="check_@area.Id">@area.Area</label>
                                    <input type="hidden" id="check_@area.Area" class="Area" value="@area.Area" />
                                    @*<input id="check_@area.Id+''+@area.BaseChargeAmount" type="number" class="base form-control" value="@area.BaseChargeAmount" />
                                    <input id="check_@area.Id+''+@area.IncreaseChargePerKg" type="number" class="increase form-control" value="@area.IncreaseChargePerKg" />*@
                                </li>
                            }
                            <li class="list-group-item">
                                <div class="col-md-offset-2 col-md-10">
                                    <input value="Approve" type="button" class="btn btn-info btn-sm" id="approveButton" />
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<div>
    @Html.ActionLink("Back to List", "Index")
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
           
            $("#approveButton").click(function () {
                var arrItem = [];
                var comaSeparatedAreaId = '';
                $("#AreaList li input[type=checkbox]").each(function (index, val) {
                    var checkId = $(val).attr("Id");
                    var piku = {
                        cuCheckId: "",
                        marchentId: "",
                        area: "",
                        basePrice: 0.0,
                        increasePrice: 0.0,
                    }
                    var arr = checkId.split('_');
                    var currentCheckedId = arr[1];
                    var isSelected = $("#" + checkId).is(":checked", true)
                    if (isSelected) {
                       
                        var areaName = $(val).attr("Area");
                        var concateArea = areaName.split('_');
                        console.log(concateArea[1], "mango");
                        if (concateArea[0] == currentCheckedId) {
                            this.piku.area = concateArea[1];
                        }
                        var basePrice = $(val).attr("BaseChargeAmount");
                        var concateBaseChargeAmount = basePrice.split('_');
                        if (concateBaseChargeAmount[0] == currentCheckedId) {
                            this.piku.basePrice = concateBaseChargeAmount[1];
                        }
                        var incPrice = $(val).attr("IncreaseChargePerKg");
                        var concateIncAmount = incPrice.split('_');
                        if (concateIncAmount[0] == currentCheckedId) {
                            this.piku.increasePrice = concateIncAmount[1];
                        }
                        arrItem.push(piku);
                    }
                    if (arrItem.length != 0) {
                        //comaSeparatedAreaId = arrItem.toString();
                        console.log(arrItem,"Mondo");
                        //$.ajax({
                        //    url: "/MarchentApprove/ApproveCreate1",
                        //    type: "POST",
                        //    data: { AreaList: comaSeparatedAreaId },
                        //    success: function (response) {

                        //    }
                        //})
                    }
                })
            })
            
        })

    </script>
}
